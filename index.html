<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema de Gera√ß√£o de Curr√≠culos Estrat√©gicos</title>
<link rel="stylesheet" href="assets/css/main.css">
<style>
    /* ‚îÄ‚îÄ Visualizador em iframe ‚îÄ‚îÄ */
    .visualizador-modal-content {
        width: 96vw;
        max-width: 1050px;
        height: 92vh;
        max-height: 92vh;
        display: flex;
        flex-direction: column;
        padding: 0;
        overflow: hidden;
    }
    .visualizador-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 16px 24px;
        border-bottom: 1px solid var(--border);
        background: white;
        border-radius: 12px 12px 0 0;
        flex-shrink: 0;
    }
    .visualizador-header h2 {
        font-size: 17px;
        font-weight: 600;
        color: var(--text);
        margin: 0;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        max-width: 60%;
    }
    .visualizador-header .header-actions {
        display: flex;
        gap: 10px;
        flex-shrink: 0;
    }
    #resumeIframe {
        flex: 1;
        width: 100%;
        border: none;
        border-radius: 0 0 12px 12px;
        background: #f9fafb;
    }

    /* ‚îÄ‚îÄ Modal de confirma√ß√£o ‚îÄ‚îÄ */
    .confirm-modal-content {
        max-width: 440px;
        text-align: center;
    }
    .confirm-icon {
        font-size: 40px;
        margin-bottom: 12px;
    }
    .confirm-modal-content h3 {
        font-size: 18px;
        font-weight: 700;
        color: var(--text);
        margin-bottom: 10px;
    }
    .confirm-modal-content p {
        color: var(--text-secondary);
        font-size: 14px;
        line-height: 1.6;
        margin-bottom: 24px;
    }
    .confirm-actions {
        display: flex;
        gap: 12px;
        justify-content: center;
    }

    /* ‚îÄ‚îÄ Modal descri√ß√£o ‚îÄ‚îÄ */
    .descricao-modal-content {
        max-width: 700px;
    }
    .descricao-modal-content h2 {
        margin-bottom: 16px;
    }
    #descricaoTexto {
        white-space: pre-wrap;
        font-size: 14px;
        line-height: 1.7;
        color: var(--text);
        background: var(--bg-secondary);
        border: 1px solid var(--border);
        border-radius: 8px;
        padding: 16px 20px;
        max-height: 60vh;
        overflow-y: auto;
    }

    /* ‚îÄ‚îÄ Spinner de carregamento no iframe ‚îÄ‚îÄ */
    .iframe-loading {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
        color: var(--text-secondary);
        font-size: 15px;
        gap: 10px;
    }
    .spinner {
        width: 22px; height: 22px;
        border: 3px solid var(--border);
        border-top-color: var(--primary);
        border-radius: 50%;
        animation: spin 0.7s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* ‚îÄ‚îÄ Bot√£o de copiar no modal de prompt ‚îÄ‚îÄ */
    .output-header .btn { font-family: inherit; }
</style>
</head>
<body>
<div class="container">
    <header class="header">
        <h1>Sistema de Gera√ß√£o de Curr√≠culos Estrat√©gicos</h1>
        <p>Crie curr√≠culos otimizados com an√°lise de elegibilidade por IA</p>
    </header>

    <div class="tabs">
        <button class="tab-btn active" data-tab="data">üìù Meus Dados</button>
        <button class="tab-btn" data-tab="vagas">üéØ Vagas</button>
    </div>

    <!-- ABA MEUS DADOS -->
    <div class="tab-content active" id="tab-data">
        <h2>Meus Dados Profissionais</h2>
        <div class="section">
            <h3>Informa√ß√µes Pessoais</h3>
            <p class="help-text">Marque as informa√ß√µes que deseja incluir nos curr√≠culos gerados:</p>
            <div class="form-grid">
                <div class="form-group">
                    <label><input type="checkbox" id="include_name" checked disabled> Nome Completo *</label>
                    <input type="text" id="name" placeholder="Jo√£o Silva Santos">
                </div>
                <div class="form-group">
                    <label><input type="checkbox" id="include_email" checked disabled> Email *</label>
                    <input type="email" id="email" placeholder="joao.silva@email.com">
                </div>
                <div class="form-group">
                    <label><input type="checkbox" id="include_phone"> Telefone / WhatsApp</label>
                    <input type="tel" id="phone" placeholder="+55 (11) 98765-4321">
                </div>
                <div class="form-group">
                    <label><input type="checkbox" id="include_city"> Cidade</label>
                    <input type="text" id="city" placeholder="S√£o Paulo">
                </div>
                <div class="form-group">
                    <label><input type="checkbox" id="include_state"> Estado</label>
                    <input type="text" id="state" placeholder="SP" maxlength="2">
                </div>
                <div class="form-group">
                    <label><input type="checkbox" id="include_remote"> Dispon√≠vel para remoto</label>
                    <input type="checkbox" id="remote">
                </div>
            </div>
            <div class="form-grid">
                <div class="form-group">
                    <label><input type="checkbox" id="include_linkedin"> LinkedIn</label>
                    <input type="url" id="linkedin" placeholder="https://linkedin.com/in/seuperfil">
                </div>
                <div class="form-group">
                    <label><input type="checkbox" id="include_github"> GitHub</label>
                    <input type="url" id="github" placeholder="https://github.com/seuusuario">
                </div>
                <div class="form-group">
                    <label><input type="checkbox" id="include_portfolio"> Portf√≥lio / Site</label>
                    <input type="url" id="portfolio" placeholder="https://seusite.dev">
                </div>
            </div>
        </div>

        <div class="section">
            <h3>Hist√≥rico Profissional</h3>
            <p class="help-text">Este hist√≥rico ser√° usado como base para gerar curr√≠culos personalizados para cada vaga.</p>
            <textarea id="history" rows="20" placeholder="Cole seu hist√≥rico profissional em Markdown"></textarea>
        </div>

        <div class="actions">
            <button class="btn btn-primary" onclick="saveData()">üíæ Salvar Dados</button>
        </div>
        <div class="status" id="saveStatus"></div>
    </div>

    <!-- ABA VAGAS -->
    <div class="tab-content" id="tab-vagas">
        <h2>Gerenciamento de Vagas</h2>
        <div class="section">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <div>
                    <label style="margin-right: 10px; font-weight: 600;">Filtrar por status:</label>
                    <select id="statusFilter" onchange="filterVagas()" style="padding: 8px 12px; border: 1px solid var(--border); border-radius: 6px;">
                        <option value="all">Todas</option>
                        <option value="criada">Criada</option>
                        <option value="aplicada">Aplicada</option>
                        <option value="entrevista">Em Entrevista</option>
                        <option value="rejeitada">Rejeitada</option>
                        <option value="desisti">Desisti</option>
                        <option value="nao_passei">N√£o Passei</option>
                    </select>
                </div>
                <button class="btn btn-primary" onclick="openNovaVagaModal()">‚ûï Nova Vaga</button>
            </div>
            <div id="vagasList"></div>
            <div id="pagination" style="display: flex; justify-content: center; gap: 10px; margin-top: 20px;"></div>
        </div>
    </div>
</div>

<!-- ============================================================ -->
<!-- MODAL: Nova Vaga -->
<!-- ============================================================ -->
<div id="novaVagaModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeNovaVagaModal()">&times;</span>
        <h2>Nova Vaga</h2>
        <div class="form-group">
            <label>Empresa *</label>
            <input type="text" id="modal_empresa" placeholder="Nome da empresa">
        </div>
        <div class="form-group">
            <label>Cargo *</label>
            <input type="text" id="modal_cargo" placeholder="Ex: Desenvolvedor Backend S√™nior">
        </div>
        <div class="form-group">
            <label>Descri√ß√£o da Vaga *</label>
            <textarea id="modal_descricao" rows="10" placeholder="Cole aqui a descri√ß√£o completa da vaga"></textarea>
        </div>
        <div class="actions">
            <button class="btn btn-primary" onclick="salvarNovaVaga()">üíæ Salvar Vaga</button>
            <button class="btn btn-secondary" onclick="closeNovaVagaModal()">Cancelar</button>
        </div>
        <div class="status" id="modalStatus"></div>
    </div>
</div>

<!-- ============================================================ -->
<!-- MODAL: Editar Vaga -->
<!-- ============================================================ -->
<div id="editVagaModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close" onclick="closeEditVagaModal()">&times;</span>
        <h2>Editar Vaga</h2>
        <input type="hidden" id="edit_uuid">
        <div class="form-group">
            <label>Empresa *</label>
            <input type="text" id="edit_empresa">
        </div>
        <div class="form-group">
            <label>Cargo *</label>
            <input type="text" id="edit_cargo">
        </div>
        <div class="form-group">
            <label>Descri√ß√£o da Vaga *</label>
            <textarea id="edit_descricao" rows="10"></textarea>
        </div>
        <div class="form-group">
            <label>Status</label>
            <select id="edit_status">
                <option value="criada">Criada</option>
                <option value="aplicada">Aplicada</option>
                <option value="entrevista">Em Entrevista</option>
                <option value="rejeitada">Rejeitada</option>
                <option value="desisti">Desisti</option>
                <option value="nao_passei">N√£o Passei</option>
            </select>
        </div>
        <div class="actions">
            <button class="btn btn-primary" onclick="salvarEdicaoVaga()">üíæ Salvar Altera√ß√µes</button>
            <button class="btn btn-secondary" onclick="closeEditVagaModal()">Cancelar</button>
        </div>
        <div class="status" id="editModalStatus"></div>
    </div>
</div>

<!-- ============================================================ -->
<!-- MODAL: Ver Descri√ß√£o da Vaga -->
<!-- ============================================================ -->
<div id="descricaoModal" class="modal" style="display: none;">
    <div class="modal-content descricao-modal-content">
        <span class="close" onclick="closeDescricaoModal()">&times;</span>
        <h2 id="descricaoTitulo">Descri√ß√£o da Vaga</h2>
        <pre id="descricaoTexto"></pre>
        <div class="actions" style="margin-top: 16px;">
            <button class="btn btn-secondary" onclick="closeDescricaoModal()">Fechar</button>
        </div>
    </div>
</div>

<!-- ============================================================ -->
<!-- MODAL: Gerar Prompt -->
<!-- ============================================================ -->
<div id="promptModal" class="modal" style="display: none;">
    <div class="modal-content modal-large">
        <span class="close" onclick="closePromptModal()">&times;</span>
        <h2>Prompt para ChatGPT</h2>
        <p class="help-text">Copie este prompt e cole no ChatGPT para gerar seu curr√≠culo estrat√©gico:</p>
        <div class="output-box">
            <div class="output-header">
                <span>üìã Prompt Completo</span>
                <button class="btn btn-small" onclick="copyPrompt()">üìã Copiar</button>
            </div>
            <pre id="generatedPrompt"></pre>
        </div>
        <div class="actions">
            <button class="btn btn-primary" onclick="avancarParaColarResposta()">‚û°Ô∏è Pr√≥xima Etapa: Colar Resposta</button>
        </div>
    </div>
</div>

<!-- ============================================================ -->
<!-- MODAL: Colar / Editar Resposta JSON -->
<!-- ============================================================ -->
<div id="respostaModal" class="modal" style="display: none;">
    <div class="modal-content modal-large">
        <span class="close" onclick="closeRespostaModal()">&times;</span>
        <h2 id="respostaModalTitulo">Colar Resposta do ChatGPT</h2>
        <input type="hidden" id="resposta_vaga_uuid">
        <p class="help-text" id="respostaModalDescricao">Cole aqui o JSON completo retornado pelo ChatGPT:</p>
        <div class="form-group">
            <textarea id="jsonResposta" rows="18" placeholder='{ "versao": "1.0.0", "data_geracao": "2025-02-16", "elegibilidade": {...}, "curriculo": {...} }'></textarea>
        </div>
        <div class="actions">
            <button id="btnGerarCurriculo" class="btn btn-success btn-large" onclick="gerarCurriculo()">‚ú® Gerar Curr√≠culo</button>
            <button id="btnVoltarPrompt" class="btn btn-secondary" onclick="voltarParaPrompt()">‚¨ÖÔ∏è Voltar</button>
        </div>
        <div class="status" id="respostaStatus"></div>
    </div>
</div>

<!-- ============================================================ -->
<!-- MODAL: Elegibilidade + A√ß√µes do Curr√≠culo -->
<!-- ============================================================ -->
<div id="curriculoModal" class="modal" style="display: none;">
    <div class="modal-content modal-large">
        <span class="close" onclick="closeCurriculoModal()">&times;</span>
        <h2>An√°lise de Elegibilidade</h2>
        <div class="section">
            <div id="eligibilityContent"></div>
        </div>
        <div class="actions">
            <button class="btn btn-success" onclick="abrirVisualizacaoCurriculo()">üëÅÔ∏è Visualizar Curr√≠culo</button>
            <button class="btn btn-primary" onclick="downloadJsonCurriculo()">üíæ Baixar JSON</button>
            <button class="btn btn-secondary" onclick="closeCurriculoModal()">Fechar</button>
        </div>
    </div>
</div>

<!-- ============================================================ -->
<!-- MODAL: Visualizador do Curr√≠culo (iframe interno) -->
<!-- ============================================================ -->
<div id="visualizadorModal" class="modal" style="display: none;">
    <div class="modal-content visualizador-modal-content">
        <div class="visualizador-header">
            <h2 id="visualizadorTitulo">Curr√≠culo</h2>
            <div class="header-actions">
                <button class="btn btn-primary btn-small" onclick="imprimirDoVisualizador()">üñ®Ô∏è Imprimir / PDF</button>
                <button class="btn btn-secondary btn-small" onclick="closeVisualizadorModal()">‚úï Fechar</button>
            </div>
        </div>
        <iframe id="resumeIframe" title="Visualizador de Curr√≠culo"></iframe>
    </div>
</div>

<!-- ============================================================ -->
<!-- MODAL: Confirma√ß√£o gen√©rica -->
<!-- ============================================================ -->
<div id="confirmModal" class="modal" style="display: none;">
    <div class="modal-content confirm-modal-content">
        <div class="confirm-icon">‚ö†Ô∏è</div>
        <h3 id="confirmTitulo">Confirmar a√ß√£o</h3>
        <p id="confirmMensagem">Tem certeza?</p>
        <div class="confirm-actions">
            <button id="confirmBtn" class="btn btn-danger">Confirmar</button>
            <button class="btn btn-secondary" onclick="closeConfirmModal()">Cancelar</button>
        </div>
    </div>
</div>

<script src="assets/js/main.js"></script>
<script src="assets/js/vagas.js"></script>
</body>
</html>